#!/bin/bash

FAIL=0

pull () {
  echo
  echo '--------------------------------------'
  echo '| ' `basename "$1"`
  echo '--------------------------------------'
  cd "$1"
  git checkout develop
  git status
  git pull -p > /dev/null &
}

pull /Users/nagi/rails/schedule-api
pull /Users/nagi/rails/fuji-engage
pull /Users/nagi/rails/fuji-notification-service
pull /Users/nagi/rails/fuji-account-service

pull /Users/nagi/js/schedule-ui
pull /Users/nagi/js/engage-ui

echo
echo 'Waiting for `git pull`s to finish...'
echo

for job in `jobs -p`
do
  wait $job || let "FAIL+=1"
done

if [ "$FAIL" == "0" ];
then
  echo "Done."
  exit 0
else
  echo "Error."
  exit 1
fi
